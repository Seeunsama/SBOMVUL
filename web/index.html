<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SBOMVUL - SBOM Vulnerability Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <link href="tooplate-nexus-brew.css" rel="stylesheet">

    <style>
      /* ==== SBOM Vulnerability Dashboard ì „ìš© ìŠ¤íƒ€ì¼ ==== */

      #menu {
        padding-top: 6rem;
        padding-bottom: 4rem;
      }

      #menu .section-inner {
        max-width: 1200px;
        margin: 0 auto;
      }

      #menu h2.glitch {
        margin-bottom: 1rem;
      }

      #menu .v-subtitle {
        color: #9ca3af;
        font-size: 0.95rem;
        margin-bottom: 1.5rem;
      }

      .v-dashboard {
        background: rgba(5, 10, 25, 0.9);
        border-radius: 1rem;
        padding: 1.5rem 1.75rem 2rem;
        box-shadow: 0 18px 45px rgba(0,0,0,0.7);
        border: 1px solid rgba(148, 163, 184, 0.2);
        backdrop-filter: blur(16px);
      }

      .v-cards {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-bottom: 1.5rem;
      }

      .v-card {
        background: radial-gradient(circle at top left, rgba(96,165,250,0.15), rgba(15,23,42,0.95));
        border-radius: 0.9rem;
        padding: 0.9rem 1rem;
        min-width: 130px;
        flex: 1 1 130px;
        border: 1px solid rgba(148,163,184,0.3);
      }

      .v-card-title {
        font-size: 0.7rem;
        text-transform: uppercase;
        letter-spacing: 0.12em;
        color: #9ca3af;
        margin-bottom: 0.15rem;
      }

      .v-card-value {
        font-size: 1.5rem;
        font-weight: 700;
        font-family: "Orbitron", system-ui, sans-serif;
      }

      .v-filters {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-bottom: 1rem;
      }

      .v-filters input,
      .v-filters select {
        background: rgba(15,23,42,0.95);
        border: 1px solid #1f2937;
        border-radius: 9999px;
        padding: 0.4rem 0.9rem;
        color: #e5e7eb;
        font-size: 0.9rem;
        font-family: "Exo 2", system-ui, sans-serif;
      }

      .v-filters input:focus,
      .v-filters select:focus {
        outline: 1px solid #6366f1;
      }

      .v-table-wrapper {
        border-radius: 0.9rem;
        overflow: hidden;
        border: 1px solid rgba(55,65,81,0.8);
        background: rgba(15,23,42,0.9);
      }

      table.v-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.85rem;
      }

      .v-table thead {
        background: rgba(15,23,42, 0.98);
      }

      .v-table th,
      .v-table td {
        padding: 0.6rem 0.8rem;
        border-bottom: 1px solid rgba(31,41,55,0.9);
        vertical-align: top;
      }

      .v-table th {
        text-align: left;
        color: #9ca3af;
        font-weight: 500;
        position: sticky;
        top: 0;
        z-index: 1;
        backdrop-filter: blur(10px);
      }

      .v-table tbody tr:hover {
        background: rgba(30,64,175,0.35);
      }

      .v-severity-badge {
        display: inline-flex;
        align-items: center;
        padding: 0.15rem 0.55rem;
        border-radius: 9999px;
        font-size: 0.7rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        font-family: "Share Tech Mono", monospace;
      }

      .v-sev-critical { background: rgba(248,113,113,0.1); color: #fecaca; border: 1px solid #f87171; }
      .v-sev-high     { background: rgba(248,113,113,0.07); color: #fca5a5; border: 1px solid #fb7185; }
      .v-sev-medium   { background: rgba(251,191,36,0.08); color: #facc15; border: 1px solid #fbbf24; }
      .v-sev-low      { background: rgba(52,211,153,0.08); color: #6ee7b7; border: 1px solid #10b981; }
      .v-sev-unknown  { background: rgba(148,163,184,0.12); color: #e5e7eb; border: 1px solid #6b7280; }

      .v-cve-link {
        color: #a5b4fc;
        text-decoration: none;
      }

      .v-cve-link:hover {
        text-decoration: underline;
      }

      .v-tag {
        display: inline-flex;
        align-items: center;
        padding: 0.15rem 0.6rem;
        border-radius: 9999px;
        font-size: 0.7rem;
        background: rgba(15,23,42,1);
        border: 1px solid rgba(55,65,81,0.9);
        color: #e5e7eb;
        font-family: "Share Tech Mono", monospace;
      }

      .v-desc {
        color: #9ca3af;
      }

      .v-desc-toggle {
        cursor: pointer;
        color: #a5b4fc;
        font-size: 0.75rem;
        margin-left: 0.25rem;
      }

      @media (max-width: 768px) {
        .v-dashboard {
          padding: 1.1rem 1.1rem 1.5rem;
        }
        .v-table th,
        .v-table td {
          font-size: 0.78rem;
        }
      }

      /* ==== About ì„¹ì…˜ ì¤‘ì•™ ì¹´ë“œ ìŠ¤íƒ€ì¼ ==== */

      #about {
        padding-top: 6rem;
        padding-bottom: 6rem;
      }

      .about-tabs {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-top: 2rem;
        margin-bottom: 2rem;
      }

      .about-content {
        display: flex;
        justify-content: center;
      }

      .about-card {
        background: rgba(5, 10, 25, 0.95);
        border-radius: 1rem;
        padding: 2rem 2.5rem;
        max-width: 800px;
        width: 100%;
        box-shadow: 0 18px 45px rgba(0,0,0,0.7);
        border: 1px solid rgba(148, 163, 184, 0.25);
      }

      .about-card h3 {
        margin-bottom: 1rem;
        color: #f472b6;
      }

      .about-card p {
        color: #e5e7eb;
        line-height: 1.7;
        font-size: 0.95rem;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      .tab-button.active {
        background: linear-gradient(90deg, #ec4899, #6366f1);
        border-color: transparent;
      }
    </style>
</head>
<body>
    <!-- Static patterns -->
    <div class="static-pattern"></div>
    <div class="hex-pattern"></div>

    <!-- Animated background shapes -->
    <div class="bg-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
        <div class="shape shape-4"></div>
        <div class="shape shape-5"></div>
    </div>

    <!-- Grid overlay -->
    <div class="grid-overlay"></div>

    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <div class="logo">SBOMVUL</div>
            <div class="menu-toggle" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <ul class="nav-links">
                <li><a href="#home" class="nav-link">Home</a></li>
                <li><a href="#menu" class="nav-link">Dashboard</a></li>
                <li><a href="#about" class="nav-link">About</a></li>
                <li><a href="#contact" class="nav-link">Contact</a></li>
            </ul>
        </div>
    </nav>

    <!-- Home Section -->
    <section id="home">
        <h1 class="hero-title">SBOMVUL</h1>
        <p class="hero-subtitle">SBOMì—ì„œ OSVÂ·NVDê¹Œì§€, ì˜¤í”ˆì†ŒìŠ¤ ê³µê¸‰ë§ ì·¨ì•½ì  í•œëˆˆì— ë³´ê¸°</p>
        <div class="hero-buttons">
            <a href="#menu" class="cta-button">VIEW VULNERABILITIES</a>
            <a href="#about" class="cta-button cta-secondary">ABOUT PROJECT</a>
        </div>
    </section>

    <!-- SBOM Vulnerability Dashboard Section -->
    <section id="menu">
        <div class="section-inner">
            <h2 class="glitch">SBOM VULNERABILITY DASHBOARD</h2>
            <p class="v-subtitle" id="subtitle">Loading vulnerabilitiesâ€¦</p>

            <div class="v-dashboard">
                <!-- Stats cards -->
                <div class="v-cards">
                    <div class="v-card">
                        <div class="v-card-title">Total</div>
                        <div class="v-card-value" id="stat-total">-</div>
                    </div>
                    <div class="v-card">
                        <div class="v-card-title">Critical</div>
                        <div class="v-card-value" id="stat-critical">-</div>
                    </div>
                    <div class="v-card">
                        <div class="v-card-title">High</div>
                        <div class="v-card-value" id="stat-high">-</div>
                    </div>
                    <div class="v-card">
                        <div class="v-card-title">Medium</div>
                        <div class="v-card-value" id="stat-medium">-</div>
                    </div>
                    <div class="v-card">
                        <div class="v-card-title">Low</div>
                        <div class="v-card-value" id="stat-low">-</div>
                    </div>
                </div>

                <!-- Filters -->
                <div class="v-filters">
                    <!-- SBOM ì„ íƒ ë“œë¡­ë‹¤ìš´ -->
                    <select id="sbom-select">
                        <option value="">Loading SBOM listâ€¦</option>
                    </select>

                    <input id="filter-text" type="text" placeholder="Search CVE ID / package / description" />
                    <select id="filter-severity">
                        <option value="">Severity: All</option>
                        <option value="critical">Critical</option>
                        <option value="high">High</option>
                        <option value="medium">Medium</option>
                        <option value="low">Low</option>
                    </select>
                </div>

                <!-- Table -->
                <div class="v-table-wrapper">
                    <table class="v-table">
                        <thead>
                            <tr>
                                <th>Severity</th>
                                <th>CVE</th>
                                <th>Score</th>
                                <th>Package</th>
                                <th>Published</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody id="vuln-table-body">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about">
        <h2 class="glitch">ABOUT</h2>
        <div class="about-tabs">
            <button class="tab-button active" onclick="showTab('story')">OVERVIEW</button>
            <button class="tab-button" onclick="showTab('mission')">GOAL</button>
            <button class="tab-button" onclick="showTab('technology')">STACK</button>
        </div>

        <div id="story" class="tab-content active">
            <div class="about-content">
                <div class="about-card">
                    <h3>SBOMVUL Analyzer</h3>
                    <p>SBOMVULì€ cdxgenìœ¼ë¡œ ìƒì„±í•œ SBOMì„ ê¸°ë°˜ìœ¼ë¡œ OSV.devì™€ NVD ë°ì´í„°ë¥¼ í†µí•©í•˜ì—¬, ì˜¤í”ˆì†ŒìŠ¤ êµ¬ì„±ìš”ì†Œì˜ ì·¨ì•½ì ì„ í•œëˆˆì— íŒŒì•…í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ë¶„ì„ ë„êµ¬ì…ë‹ˆë‹¤.</p>
                    <br>
                    <p>ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ SBOMì„ ìƒì„±í•˜ê³ , ì·¨ì•½ì  ë§¤í•‘ ìŠ¤í¬ë¦½íŠ¸ë¡œ CVE, CVSS ì ìˆ˜, ì˜í–¥ ë°›ëŠ” íŒ¨í‚¤ì§€ë¥¼ ìë™ìœ¼ë¡œ ìˆ˜ì§‘í•œ ë’¤, ì´ ì›¹ ëŒ€ì‹œë³´ë“œì—ì„œ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>

        <div id="mission" class="tab-content">
            <div class="about-content">
                <div class="about-card">
                    <h3>Shift Left Security</h3>
                    <p>ëª©í‘œëŠ” ê°œë°œìê°€ ë¹Œë“œÂ·ë°°í¬ ë‹¨ê³„ ì´ì „ì— SBOM ê¸°ë°˜ ì·¨ì•½ì  ì •ë³´ë¥¼ ì‰½ê²Œ í™•ì¸í•˜ê³ , ìš°ì„ ìˆœìœ„ë¥¼ ì •í•´ ì„ ì œì ìœ¼ë¡œ ëŒ€ì‘í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>
                    <br>
                    <p>ê°œë°œíŒ€ì´ â€œì–´ë–¤ OSSë¥¼ ì–´ë–¤ ë²„ì „ìœ¼ë¡œ ì“°ê³  ìˆê³ , ì–´ë””ì— ì–´ë–¤ ì·¨ì•½ì ì´ ìˆëŠ”ì§€â€ë¥¼ í•œ í™”ë©´ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆê²Œ í•¨ìœ¼ë¡œì¨, ë³´ì•ˆ ì´ìŠˆë¥¼ ìš´ì˜ ë‹¨ê³„ê°€ ì•„ë‹ˆë¼ ê°œë°œ ë‹¨ê³„ì—ì„œ ë¯¸ë¦¬ ì°¨ë‹¨í•˜ëŠ” ê²ƒì„ ì§€í–¥í•©ë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>

        <div id="technology" class="tab-content">
            <div class="about-content">
                <div class="about-card">
                    <h3>Tech Stack</h3>
                    <p>cdxgen, CycloneDX SBOM, OSV.dev API, NVD JSON Feed, Python(Pandas) ê¸°ë°˜ ë¶„ì„ ìŠ¤í¬ë¦½íŠ¸, ê·¸ë¦¬ê³  ì»¨í…Œì´ë„ˆ í™˜ê²½ ìœ„ì—ì„œ ë™ì‘í•˜ëŠ” ìë™í™” íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.</p>
                    <br>
                    <p>ì›¹ UIëŠ” ì •ì  HTML/JavaScriptë¡œ êµ¬ì„±ë˜ì–´ SBOM ê²°ê³¼(JSON)ë¥¼ ì½ì–´ì™€ ëŒ€ì‹œë³´ë“œ í˜•íƒœë¡œ ë Œë”ë§í•˜ë©°, CI íŒŒì´í”„ë¼ì¸ì— ì‰½ê²Œ ë¶™ì¼ ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact">
        <h2 class="glitch">CONTACT</h2>
        <div class="contact-container">
            <div class="contact-form">
                <form onsubmit="event.preventDefault(); alert('Message sent!');">
                    <div class="form-group">
                        <label for="name">Name / Handle</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email or GitHub</label>
                        <input type="text" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="message">Message</label>
                        <textarea id="message" name="message" rows="5" required></textarea>
                    </div>
                    <button type="submit" class="submit-btn">Send</button>
                </form>
            </div>

            <div class="contact-info">
                <h3>Project Info</h3>
                <div class="info-item">
                    <div class="info-icon">ğŸ“</div>
                    <div class="info-text">
                        <strong>Repository</strong><br>
                        <a href="https://github.com/Seeunsama" target="_blank" rel="noopener noreferrer">
                            https://github.com/Seeunsama
                        </a>
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-icon">ğŸ”</div>
                    <div class="info-text">
                        <strong>Focus</strong><br>
                        SBOM Â· Supply Chain Security Â· OSV/NVD Integration
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-links">
                <a href="#privacy">Privacy Policy</a>
                <a href="#terms">Terms of Service</a>
                <a href="#careers">Careers</a>
            </div>
            <div class="copyright">
            Â© 2026 SBOMVUL. All rights reserved.
            <br> Design base: <a href="https://www.tooplate.com" target="_blank" rel="nofollow noopener">Tooplate</a></div>
        </div>
    </footer>

    <script src="tooplate-nexus-scripts.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // index.html ê¸°ì¤€: JSONì€ ../sbom_data/ ë°‘ì— ì €ì¥ë¨
        const DATA_BASE = "../sbom_data/";
        const INDEX_URL = "sbom_index.json";

        const statEls = {
          total: document.getElementById("stat-total"),
          critical: document.getElementById("stat-critical"),
          high: document.getElementById("stat-high"),
          medium: document.getElementById("stat-medium"),
          low: document.getElementById("stat-low"),
        };
        const subtitleEl = document.getElementById("subtitle");
        const tbody = document.getElementById("vuln-table-body");
        const filterTextEl = document.getElementById("filter-text");
        const filterSeverityEl = document.getElementById("filter-severity");
        const sbomSelectEl = document.getElementById("sbom-select");

        let allVulns = [];
        let currentFile = null;
        let currentLabel = "";

        function severityClass(sev) {
          if (!sev) return "v-sev-unknown";
          const s = sev.toLowerCase();
          if (s === "critical") return "v-sev-critical";
          if (s === "high")     return "v-sev-high";
          if (s === "medium")   return "v-sev-medium";
          if (s === "low")      return "v-sev-low";
          return "v-sev-unknown";
        }

        // description í•œ ì¤„ ìš”ì•½ (Markdown ì œê±° + "This vulnerability" ì´í›„ ìš°ì„ )
        function oneLineSummary(text, length = 150) {
          if (!text) return "";

          let cleaned = text
            .replace(/\*\*/g, "")             // **ê¸°í˜¸ ì œê±°
            .replace(/\*/g, "")               // *ê¸°í˜¸ ì œê±°
            .replace(/^Impact.*?:/i, "")      // "Impact: ..." prefix ì œê±°
            .replace(/^Impact/i, "")          // "Impact" ë‹¨ë… ì œê±°
            .replace(/^What.*?\?/i, "")       // "What kind of vulnerability..." ì œê±°
            .replace(/\s+/g, " ")             // ê³µë°± ì •ë¦¬
            .trim();

          const idx = cleaned.indexOf("This vulnerability");
          if (idx !== -1) cleaned = cleaned.slice(idx);

          if (cleaned.length > length)
            cleaned = cleaned.slice(0, length) + "â€¦";

          return cleaned;
        }

        function renderStats(vulns) {
          const totals = {
            total: vulns.length,
            critical: 0,
            high: 0,
            medium: 0,
            low: 0,
          };

          vulns.forEach(v => {
            const sev = (v.ratings && v.ratings[0] && v.ratings[0].severity || "").toLowerCase();
            if (["critical","high","medium","low"].includes(sev)) {
              totals[sev]++;
            }
          });

          statEls.total.textContent    = totals.total;
          statEls.critical.textContent = totals.critical;
          statEls.high.textContent     = totals.high;
          statEls.medium.textContent   = totals.medium;
          statEls.low.textContent      = totals.low;
        }

        function renderTable(vulns) {
          tbody.innerHTML = "";

          const sorted = vulns.slice().sort((a, b) => {
            const ra = (a.ratings && a.ratings[0]) || {};
            const rb = (b.ratings && b.ratings[0]) || {};
            const sa = (ra.score !== undefined ? Number(ra.score) : -1);
            const sb = (rb.score !== undefined ? Number(rb.score) : -1);
            return sb - sa;
          });

          sorted.forEach(v => {
            const tr = document.createElement("tr");

            const rating = (v.ratings && v.ratings[0]) || {};
            const sev = rating.severity || "unknown";
            const score = rating.score ?? "";

            const firstAffect = (v.affects && v.affects[0] && v.affects[0].ref) || "";

            const sevTd = document.createElement("td");
            const sevSpan = document.createElement("span");
            sevSpan.className = "v-severity-badge " + severityClass(sev);
            sevSpan.textContent = (sev || "unknown").toUpperCase();
            sevTd.appendChild(sevSpan);

            const cveTd = document.createElement("td");
            const cveLink = document.createElement("a");
            cveLink.href = v.source && v.source.url ? v.source.url : "#";
            cveLink.target = "_blank";
            cveLink.rel = "noreferrer";
            cveLink.textContent = v.id;
            cveLink.className = "v-cve-link";
            cveTd.appendChild(cveLink);

            const scoreTd = document.createElement("td");
            scoreTd.textContent = score !== "" ? String(score) : "";

            const pkgTd = document.createElement("td");
            if (firstAffect) {
              const tag = document.createElement("span");
              tag.className = "v-tag";
              tag.textContent = firstAffect;
              pkgTd.appendChild(tag);
            }

            const pubTd = document.createElement("td");
            pubTd.textContent = v.published ? v.published.split("T")[0] : "";

            const descTd = document.createElement("td");
            descTd.className = "v-desc";
            descTd.textContent = oneLineSummary(v.description || "");

            tr.appendChild(sevTd);
            tr.appendChild(cveTd);
            tr.appendChild(scoreTd);
            tr.appendChild(pkgTd);
            tr.appendChild(pubTd);
            tr.appendChild(descTd);

            tbody.appendChild(tr);
          });
        }

        function applyFilters() {
          const text = filterTextEl.value.toLowerCase();
          const sevFilter = filterSeverityEl.value.toLowerCase();

          const filtered = allVulns.filter(v => {
            const rating = (v.ratings && v.ratings[0]) || {};
            const sev = (rating.severity || "").toLowerCase();
            const firstAffect = (v.affects && v.affects[0] && v.affects[0].ref) || "";
            const composite = [
              v.id || "",
              firstAffect,
              v.description || "",
            ].join(" ").toLowerCase();

            const matchText = !text || composite.includes(text);
            const matchSev = !sevFilter || sev === sevFilter;

            return matchText && matchSev;
          });

          renderStats(filtered);
          renderTable(filtered);
          subtitleEl.textContent =
            `Showing ${filtered.length} of ${allVulns.length} vulnerabilities` +
            (currentLabel ? ` (SBOM: ${currentLabel})` : "");
        }

        function loadVulns(fileName) {
          if (!fileName) {
            allVulns = [];
            renderStats(allVulns);
            renderTable(allVulns);
            subtitleEl.textContent = "No SBOM selected.";
            return;
          }

          currentFile = fileName;
          const opt = sbomSelectEl.options[sbomSelectEl.selectedIndex];
          currentLabel = opt ? opt.textContent : fileName;
          subtitleEl.textContent = `Loading vulnerabilities from ${currentLabel}â€¦`;

          fetch(DATA_BASE + fileName)
            .then(r => {
              if (!r.ok) throw new Error(`HTTP ${r.status}`);
              return r.json();
            })
            .then(data => {
              if (Array.isArray(data)) {
                allVulns = data;
              } else if (Array.isArray(data.vulnerabilities)) {
                allVulns = data.vulnerabilities;
              } else {
                console.warn("Unexpected JSON structure", data);
                allVulns = [];
              }

              renderStats(allVulns);
              renderTable(allVulns);
              subtitleEl.textContent =
                `Loaded ${allVulns.length} vulnerabilities from ${currentLabel}`;
            })
            .catch(err => {
              console.error(err);
              allVulns = [];
              renderStats(allVulns);
              renderTable(allVulns);
              subtitleEl.textContent = `Failed to load ${currentLabel}`;
            });
        }

        function initSbomSelect() {
          fetch(INDEX_URL)
            .then(r => {
              if (!r.ok) throw new Error(`HTTP ${r.status}`);
              return r.json();
            })
            .then(index => {
              const items = index.items || [];
              sbomSelectEl.innerHTML = "";

              if (!items.length) {
                const opt = document.createElement("option");
                opt.value = "";
                opt.textContent = "No SBOM data";
                sbomSelectEl.appendChild(opt);
                loadVulns(null);
                return;
              }

              items.forEach(item => {
                const opt = document.createElement("option");
                opt.value = item.file;
                opt.textContent = item.label;   // ì—¬ê¸°ì—ëŠ” text-generation-webui ê°™ì€ ì§§ì€ ì´ë¦„
                sbomSelectEl.appendChild(opt);
              });

              const initialFile =
                index.latest ||
                (items[0] && items[0].file);

              if (initialFile) {
                sbomSelectEl.value = initialFile;
                loadVulns(initialFile);
              }
            })
            .catch(err => {
              console.error(err);
              sbomSelectEl.innerHTML = "";
              const opt = document.createElement("option");
              opt.value = "";
              opt.textContent = "Failed to load SBOM index";
              sbomSelectEl.appendChild(opt);
              loadVulns(null);
            });

          sbomSelectEl.addEventListener("change", () => {
            const fileName = sbomSelectEl.value;
            loadVulns(fileName || null);
          });
        }

        filterTextEl.addEventListener("input", applyFilters);
        filterSeverityEl.addEventListener("change", applyFilters);

        // ì´ˆê¸°: SBOM ëª©ë¡ ë¡œë”©
        initSbomSelect();
      });

      // About íƒ­ ì „í™˜ í•¨ìˆ˜ (OVERVIEW / GOAL / STACK)
      function showTab(tabName, el) {
        const tabs = document.querySelectorAll(".tab-content");
        const buttons = document.querySelectorAll(".tab-button");

        const clickedButton =
          el ||
          (typeof event !== "undefined" && (event.currentTarget || event.target)) ||
          null;

        tabs.forEach(tab => tab.classList.remove("active"));
        buttons.forEach(btn => btn.classList.remove("active"));

        const target = document.getElementById(tabName);
        if (target) target.classList.add("active");
        if (clickedButton) clickedButton.classList.add("active");
      }
    </script>

</body>
</html>
