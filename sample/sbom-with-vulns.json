[
  {
    "id": "CVE-2023-36464",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-4vvm-4w3v-6mr8"
    },
    "description": "### Impact An attacker who uses this vulnerability can craft a PDF which leads to an infinite loop if `__parse_content_stream` is executed. This infinite loop blocks the current process and can utilize a single core of the CPU by 100%. It does not affect memory usage. That is, for example, the case if the user extracted text from such a PDF. Example Code and a PDF that causes the issue: ```python from pypdf import PdfReader # (https://objects.githubusercontent.com/github-production-repository-file-5c1aeb/3119517/11367871?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20230627%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20230627T201018Z&X-Amz-Expires=300&X-Amz-Signature=d71c8fd9181c4875f0c04d563b6d32f1d4da6e7b2e6be2f14479ce4ecdc9c8b2&X-Amz-SignedHeaders=host&actor_id=1658117&key_id=0&repo_id=3119517&response-content-disposition=attachment%3Bfilename%3DMiFO_LFO_FEIS_NOA_Published.3.pdf&response-content-type=application%2Fpdf) reader = PdfReader(\"MiFO_LFO_FEIS_NOA_Published.3.pdf\") page = reader.pages[0] page.extract_text() ``` The issue was introduced with (https://github.com/py-pdf/pypdf/pull/969) ### Patches The issue was fixed with (https://github.com/py-pdf/pypdf/pull/1828) ### Workarounds It is recommended to upgrade to `pypdf>=3.9.0`. PyPDF2 users should migrate to pypdf. If you cannot update your version of pypdf, you should modify `pypdf/generic/_data_structures.py`: ``` OLD: while peek not in (b\"\\r\", b\"\\n\"): NEW: while peek not in (b\"\\r\", b\"\\n\", b\"\"): ```",
    "ratings": [
      {
        "severity": "medium",
        "score": 6.2,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
      }
    ],
    "published": "2023-06-30T20:33:57Z",
    "updated": "2024-02-16T08:11:47.539811Z",
    "affects": [
      {
        "ref": "pkg:pypi/pypdf2@3.0.1"
      }
    ]
  },
  {
    "id": "CVE-2024-47871",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-279j-x4gx-hfrh"
    },
    "description": "### Impact **What kind of vulnerability is it? Who is impacted?** This vulnerability involves **insecure communication** between the FRP (Fast Reverse Proxy) client and server when Gradio's `share=True` option is used. HTTPS is not enforced on the connection, allowing attackers to intercept and read files uploaded to the Gradio server, as well as modify responses or data sent between the client and server. This impacts users who are sharing Gradio demos publicly over the internet using `share=True` without proper encryption, exposing sensitive data to potential eavesdroppers. ### Patches Yes, please upgrade to `gradio>=5` to address this issue. ### Workarounds **Is there a way for users to fix or remediate the vulnerability without upgrading?** As a workaround, users can avoid using `share=True` in production environments and instead host their Gradio applications on servers with HTTPS enabled to ensure secure communication.",
    "ratings": [
      {
        "severity": "critical",
        "score": 9.1,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N"
      }
    ],
    "published": "2024-10-10T22:08:51Z",
    "updated": "2025-01-21T17:27:58.400272Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      },
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-47166",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-37qc-qgx6-9xjv"
    },
    "description": "### Impact **What kind of vulnerability is it? Who is impacted?** This vulnerability involves a **one-level read path traversal** in the `/custom_component` endpoint. Attackers can exploit this flaw to access and leak source code from custom Gradio components by manipulating the file path in the request. Although the traversal is limited to a single directory level, it could expose proprietary or sensitive code that developers intended to keep private. This impacts users who have developed custom Gradio components and are hosting them on publicly accessible servers. ### Patches Yes, please upgrade to `gradio>=4.44` to address this issue. ### Workarounds **Is there a way for users to fix or remediate the vulnerability without upgrading?** As a workaround, developers can sanitize the file paths and ensure that components are not stored in publicly accessible directories.",
    "ratings": [
      {
        "severity": "medium",
        "score": 5.3,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
      }
    ],
    "published": "2024-10-10T21:36:43Z",
    "updated": "2025-01-21T18:19:28.009793Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      },
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-47084",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-3c67-5hwx-f6wx"
    },
    "description": "### Impact **What kind of vulnerability is it? Who is impacted?** This vulnerability is related to **CORS origin validation**, where the Gradio server fails to validate the request origin when a cookie is present. This allows an attacker s website to make unauthorized requests to a local Gradio server. Potentially, attackers can upload files, steal authentication tokens, and access user data if the victim visits a malicious website while logged into Gradio. This impacts users who have deployed Gradio locally and use basic authentication. ### Patches Yes, please upgrade to `gradio>=4.44` to address this issue. ### Workarounds **Is there a way for users to fix or remediate the vulnerability without upgrading?** As a workaround, users can manually enforce stricter CORS origin validation by modifying the `CustomCORSMiddleware` class in their local Gradio server code. Specifically, they can bypass the condition that skips CORS validation for requests containing cookies to prevent potential exploitation.",
    "ratings": [
      {
        "severity": "high",
        "score": 8.3,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:L"
      }
    ],
    "published": "2024-10-10T21:20:06Z",
    "updated": "2025-01-21T18:20:57.276539Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      },
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-48052",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-3gf9-wv65-gwh9"
    },
    "description": "In gradio <=4.42.0, the gr.DownloadButton function has a hidden server-side request forgery (SSRF) vulnerability. The reason is that within the save_url_to_cache function, there are no restrictions on the URL, which allows access to local target resources. This can lead to the download of local resources and sensitive information.",
    "ratings": [
      {
        "severity": "medium",
        "score": 6.5,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
      }
    ],
    "published": "2024-11-05T00:31:28Z",
    "updated": "2024-11-07T15:42:50.238036Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-47868",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-4q3c-cj7g-jcwf"
    },
    "description": "### Impact **What kind of vulnerability is it? Who is impacted?** This is a **data validation vulnerability** affecting several Gradio components, which allows arbitrary file leaks through the post-processing step. Attackers can exploit these components by crafting requests that bypass expected input constraints. This issue could lead to sensitive files being exposed to unauthorized users, especially when combined with other vulnerabilities, such as issue TOB-GRADIO-15. The components most at risk are those that return or handle file data. ### Vulnerable Components: 1. **String to FileData:** DownloadButton, Audio, ImageEditor, Video, Model3D, File, UploadButton. 2. **Complex data to FileData:** Chatbot, MultimodalTextbox. 3. **Direct file read in preprocess:** Code. 4. **Dictionary converted to FileData:** ParamViewer, Dataset. ### Exploit Scenarios: 1. A developer creates a Dropdown list that passes values to a DownloadButton. An attacker bypasses the allowed inputs, sends an arbitrary file path (like `/etc/passwd`), and downloads sensitive files. 2. An attacker crafts a malicious payload in a ParamViewer component, leaking sensitive files from a server through the arbitrary file leak. ### Patches Yes, the issue has been resolved in `gradio>5.0`. Upgrading to the latest version will mitigate this vulnerability.",
    "ratings": [
      {
        "severity": "high",
        "score": 7.5,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
      }
    ],
    "published": "2024-10-10T22:03:03Z",
    "updated": "2025-01-21T17:36:04.600886Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      },
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-47167",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-576c-3j53-r9jj"
    },
    "description": "### Impact **What kind of vulnerability is it? Who is impacted?** This vulnerability relates to **Server-Side Request Forgery (SSRF)** in the `/queue/join` endpoint. Gradio s `async_save_url_to_cache` function allows attackers to force the Gradio server to send HTTP requests to user-controlled URLs. This could enable attackers to target internal servers or services within a local network and possibly exfiltrate data or cause unwanted internal requests. Additionally, the content from these URLs is stored locally, making it easier for attackers to upload potentially malicious files to the server. This impacts users deploying Gradio servers that use components like the Video component which involve URL fetching. ### Patches Yes, please upgrade to `gradio>=5` to address this issue. ### Workarounds **Is there a way for users to fix or remediate the vulnerability without upgrading?** As a workaround, users can disable or heavily restrict URL-based inputs in their Gradio applications to trusted domains only. Additionally, implementing stricter URL validation (such as allowinglist-based validation) and ensuring that local or internal network addresses cannot be requested via the `/queue/join` endpoint can help mitigate the risk of SSRF attacks.",
    "ratings": [
      {
        "severity": "critical",
        "score": 9.8,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
      }
    ],
    "published": "2024-10-10T22:01:44Z",
    "updated": "2025-01-21T18:21:58.098515Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      },
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-8966",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-5cpq-9538-jm2j"
    },
    "description": "A vulnerability in the file upload process of gradio-app/gradio version @gradio/video@0.10.2 allows for a Denial of Service (DoS) attack. An attacker can append a large number of characters to the end of a multipart boundary, causing the system to continuously process each character and issue warnings. This can render Gradio inaccessible for extended periods, disrupting services and causing significant downtime.",
    "ratings": [
      {
        "severity": "high",
        "score": 7.5,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
      }
    ],
    "published": "2025-03-20T12:32:49Z",
    "updated": "2025-10-16T08:45:29.164327Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-47164",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-77xq-6g77-h274"
    },
    "description": "### Impact **What kind of vulnerability is it? Who is impacted?** This vulnerability relates to the **bypass of directory traversal checks** within the `is_in_or_equal` function. This function, intended to check if a file resides within a given directory, can be bypassed with certain payloads that manipulate file paths using `..` (parent directory) sequences. Attackers could potentially access restricted files if they are able to exploit this flaw, although the difficulty is high. This primarily impacts users relying on Gradio s blocklist or directory access validation, particularly when handling file uploads. ### Patches Yes, please upgrade to `gradio>=5.0` to address this issue. ### Workarounds **Is there a way for users to fix or remediate the vulnerability without upgrading?** As a workaround, users can manually sanitize and normalize file paths in their Gradio deployment before passing them to the `is_in_or_equal` function. Ensuring that all file paths are properly resolved and absolute can help mitigate the bypass vulnerabilities caused by the improper handling of `..` sequences or malformed paths.",
    "ratings": [
      {
        "severity": "medium",
        "score": 6.5,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N"
      }
    ],
    "published": "2024-10-10T21:27:47Z",
    "updated": "2025-01-21T18:21:41.142630Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      },
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-8021",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-7v2w-h4gh-w5cv"
    },
    "description": "An open redirect vulnerability exists in the latest version of gradio-app/gradio. The vulnerability allows an attacker to redirect users to a malicious website by URL encoding. This can be exploited by sending a crafted request to the application, which results in a 302 redirect to an attacker-controlled site.",
    "ratings": [
      {
        "severity": "medium",
        "score": 6.1,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
      }
    ],
    "published": "2025-03-20T12:32:47Z",
    "updated": "2025-03-21T21:45:28.785186Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-10569",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-7xmc-vhjp-qv5q"
    },
    "description": "A vulnerability in the dataframe component of gradio-app/gradio (version git 98cbcae) allows for a zip bomb attack. The component uses pd.read_csv to process input values, which can accept compressed files. An attacker can exploit this by uploading a maliciously crafted zip bomb, leading to a server crash and causing a denial of service.",
    "ratings": [
      {
        "severity": "high",
        "score": 7.5,
        "method": "CVSSv30",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
      }
    ],
    "published": "2025-03-20T12:32:39Z",
    "updated": "2025-03-20T20:59:16.359127Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-47165",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-89v2-pqfv-c5r9"
    },
    "description": "### Impact **What kind of vulnerability is it? Who is impacted?** This vulnerability relates to **CORS origin validation accepting a null origin**. When a Gradio server is deployed locally, the `localhost_aliases` variable includes \"null\" as a valid origin. This allows attackers to make unauthorized requests from sandboxed iframes or other sources with a null origin, potentially leading to data theft, such as user authentication tokens or uploaded files. This impacts users running Gradio locally, especially those using basic authentication. ### Patches Yes, please upgrade to `gradio>=5.0` to address this issue. ### Workarounds **Is there a way for users to fix or remediate the vulnerability without upgrading?** As a workaround, users can manually modify the `localhost_aliases` list in their local Gradio deployment to exclude \"null\" as a valid origin. By removing this value, the Gradio server will no longer accept requests from sandboxed iframes or sources with a null origin, mitigating the potential for exploitation.",
    "ratings": [
      {
        "severity": "medium",
        "score": 5.4,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N"
      }
    ],
    "published": "2024-10-10T21:36:36Z",
    "updated": "2025-01-21T18:20:37.159111Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      },
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-47867",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-8c87-gvhj-xm8m"
    },
    "description": "### Impact This vulnerability is a **lack of integrity check** on the downloaded FRP client, which could potentially allow attackers to introduce malicious code. If an attacker gains access to the remote URL from which the FRP client is downloaded, they could modify the binary without detection, as the Gradio server does not verify the file's checksum or signature. **Who is impacted?** Any users utilizing the Gradio server's sharing mechanism that downloads the FRP client could be affected by this vulnerability, especially those relying on the executable binary for secure data tunneling. ### Patches Yes, please upgrade to `gradio>=5.0`, which includes a fix to verify the integrity of the downloaded binary. ### Workarounds There is no direct workaround for this issue without upgrading. However, users can manually validate the integrity of the downloaded FRP client by implementing checksum or signature verification in their own environment to ensure the binary hasn't been tampered with.",
    "ratings": [
      {
        "severity": "high",
        "score": 7.5,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
      }
    ],
    "published": "2024-10-10T22:02:52Z",
    "updated": "2025-01-21T17:28:37.459668Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      },
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2025-48889",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-8jw3-6x8j-v96g"
    },
    "description": "An arbitrary file copy vulnerability in Gradio's flagging feature allows unauthenticated attackers to copy any readable file from the server's filesystem. While attackers can't read these copied files, they can cause DoS by copying large files (like /dev/urandom) to fill disk space. ### Description The flagging component doesn't properly validate file paths before copying files. Attackers can send specially crafted requests to the `/gradio_api/run/predict` endpoint to trigger these file copies. **Source**: User-controlled `path` parameter in the flagging functionality JSON payload **Sink**: `shutil.copy` operation in `FileData._copy_to_dir()` method The vulnerable code flow: 1. A JSON payload is sent to the `/gradio_api/run/predict` endpoint 2. The `path` field within `FileData` object can reference any file on the system 3. When processing this request, the `Component.flag()` method creates a `GradioDataModel` object 4. The `FileData._copy_to_dir()` method uses this path without proper validation: ```python def _copy_to_dir(self, dir: str) -> FileData: pathlib.Path(dir).mkdir(exist_ok=True) new_obj = dict(self) if not self.path: raise ValueError(\"Source file path is not set\") new_name = shutil.copy(self.path, dir) # vulnerable sink new_obj[\"path\"] = new_name return self.__class__(**new_obj) ``` 5. The lack of validation allows copying any file the Gradio process can read ### PoC The following script demonstrates the vulnerability by copying `/etc/passwd` from the server to Gradio's flagged directory: Setup a Gradio app: ```python import gradio as gr def image_classifier(inp): return {'cat': 0.2, 'dog': 0.8} test = gr.Interface(fn=image_classifier, inputs=\"image\", outputs=\"label\") test.launch(share=True) ``` Run the PoC: ```python import requests url = \"(https://[your-gradio-app-url]/gradio_api/run/predict\") headers = { \"Content-Type\": \"application/json\", \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36\" } payload = { \"data\": [ { \"path\": \"/etc/passwd\", \"url\": \"[your-gradio-app-url]\", \"orig_name\": \"network_config\", \"size\": 5000, \"mime_type\": \"text/plain\", \"meta\": { \"_type\": \"gradio.FileData\" } }, {} ], \"event_data\": None, \"fn_index\": 4, \"trigger_id\": 11, \"session_hash\": \"test123\" } response = requests.post(url, headers=headers, json=payload) print(f\"Status Code: {response.status_code}\") print(f\"Response Body: {response.text}\") ```",
    "ratings": [
      {
        "severity": "medium",
        "score": 5.3,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L"
      }
    ],
    "published": "2025-05-29T22:36:59Z",
    "updated": "2025-05-30T16:01:22.198619Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-47872",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-gvv6-33j7-884g"
    },
    "description": "### Impact **What kind of vulnerability is it? Who is impacted?** This vulnerability involves **Cross-Site Scripting (XSS)** on any Gradio server that allows file uploads. Authenticated users can upload files such as HTML, JavaScript, or SVG files containing malicious scripts. When other users download or view these files, the scripts will execute in their browser, allowing attackers to perform unauthorized actions or steal sensitive information from their sessions. This impacts any Gradio server that allows file uploads, particularly those using components that process or display user-uploaded files. ### Patches Yes, please upgrade to `gradio>=5` to address this issue. ### Workarounds **Is there a way for users to fix or remediate the vulnerability without upgrading?** As a workaround, users can restrict the types of files that can be uploaded to the Gradio server by limiting uploads to non-executable file types such as images or text. Additionally, developers can implement server-side validation to sanitize uploaded files, ensuring that HTML, JavaScript, and SVG files are properly handled or rejected before being stored or displayed to users.",
    "ratings": [
      {
        "severity": "medium",
        "score": 5.4,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N"
      }
    ],
    "published": "2024-10-10T22:09:44Z",
    "updated": "2025-01-21T17:28:03.888085Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      },
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-47168",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-hm3c-93pg-4cxw"
    },
    "description": "### Impact What kind of vulnerability is it? Who is impacted? This vulnerability involves data exposure due to the enable_monitoring flag not properly disabling monitoring when set to False. Even when monitoring is supposedly disabled, an attacker or unauthorized user can still access the monitoring dashboard by directly requesting the /monitoring endpoint. This means that sensitive application analytics may still be exposed, particularly in environments where monitoring is expected to be disabled. Users who set enable_monitoring=False to prevent unauthorized access to monitoring data are impacted. ### Patches Yes, please upgrade to gradio>=4.44 to address this issue.",
    "ratings": [
      {
        "severity": "medium",
        "score": 4.3,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
      }
    ],
    "published": "2024-10-10T22:02:30Z",
    "updated": "2025-01-21T18:21:53.376541Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      },
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2025-23042",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-j2jg-fq62-7c3h"
    },
    "description": "## Summary Gradio's Access Control List (ACL) for file paths can be bypassed by altering the letter case of a blocked file or directory path. This vulnerability arises due to the lack of case normalization in the file path validation logic. On case-insensitive file systems, such as those used by Windows and macOS, this flaw enables attackers to circumvent security restrictions and access sensitive files that should be protected. This issue can lead to unauthorized data access, exposing sensitive information and undermining the integrity of Gradio's security model. Given Gradio's popularity for building web applications, particularly in machine learning and AI, this vulnerability may pose a substantial threat if exploited in production environments. ## Affected Version Gradio <= 5.6.0 ## Impact - **Unauthorized Access**: Sensitive files or directories specified in `blocked_paths` can be accessed by attackers. - **Data Exposure**: Critical files, such as configuration files or user data, may be leaked. - **Security Breach**: This can lead to broader application or system compromise if sensitive files contain credentials or API keys. ## Root Cause The [`blocked_paths`](https://github.com/gradio-app/gradio/blob/main/gradio/blocks.py#L2310) parameter in Gradio block's initial configuration is designed to restrict user access to specific files or directories in the local file system. However, it does not account for case-insensitive operating systems, such as Windows and macOS. This oversight enables attackers to bypass ACL restrictions by changing the case of file paths. Vulnerable snippet: ```python # (https://github.com/gradio-app/gradio/blob/main/gradio/utils.py#L1500-L1517) def is_allowed_file( path: Path, blocked_paths: Sequence[str | Path], allowed_paths: Sequence[str | Path], created_paths: Sequence[str | Path], ) -> tuple[ bool, Literal[\"in_blocklist\", \"allowed\", \"created\", \"not_created_or_allowed\"] ]: in_blocklist = any( is_in_or_equal(path, blocked_path) for blocked_path in blocked_paths ) if in_blocklist: return False, \"in_blocklist\" if any(is_in_or_equal(path, allowed_path) for allowed_path in allowed_paths): return True, \"allowed\" if any(is_in_or_equal(path, created_path) for created_path in created_paths): return True, \"created\" return False, \"not_created_or_allowed\" ``` Gradio relies on `is_in_or_equal` to determine if a file path is restricted. However, this logic fails to handle case variations in paths on case-insensitive file systems, leading to the bypass. ## Proof of Concept (PoC) ### Steps to Reproduce - Deploy a Gradio demo app on a case-insensitive operating system (e.g., Windows or macOS). ```bash import gradio as gr def update(name): return f\"Welcome to Gradio, {name}!\" with gr.Blocks() as demo: gr.Markdown(\"Start typing below and then click **Run** to see the output.\") with gr.Row(): inp = gr.Textbox(placeholder=\"What is your name?\") out = gr.Textbox() btn = gr.Button(\"Run\") btn.click(fn=update, inputs=inp, outputs=out) demo.launch(blocked_paths=['resources/admin'], allowed_paths=['resources/']) ``` - Set up the file system: - Create a folder named `resources` in the same directory as the app, containing a file `1.txt`. - Inside the `resources` folder, create a subfolder named `admin` containing a sensitive file `credential.txt` (this file should be inaccessible due to `blocked_paths`). - Perform the attack: - Access the sensitive file using a case-altered path: ``` (http://127.0.0.1:PORT/gradio_api/file=resources/adMin/credential.txt) ``` ### Expected Result Access to `resources/admin/credential.txt` should be blocked. ### Actual Result By altering the case in the path (e.g., `adMin`), the blocked ACL is bypassed, and unauthorized access to the sensitive file is granted. ![image-20241119172439042](https://api.2h0ng.wiki:443/noteimages/2024/11/19/17-24-39-883969d4c31ce8a8d2a939654fab56d4.png) This demonstration highlights that flipping the case of restricted paths allows attackers to bypass Gradio's ACL and access sensitive data. ## Remediation Recommendations 1. **Normalize Path Case**: - Before evaluating paths against the ACL, normalize the case of both the requested path and the blocked paths (e.g., convert all paths to lowercase). - Example: ```python normalized_path = str(path).lower() normalized_blocked_paths = [str(p).lower() for p in blocked_paths] ``` 2. **Update Documentation**: - Warn developers about potential risks when deploying Gradio on case-insensitive file systems. 3. **Release Security Patches**: - Notify users of the vulnerability and release an updated version of Gradio with the fixed logic. ##",
    "ratings": [
      {
        "severity": "high",
        "score": 7.5,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
      }
    ],
    "published": "2025-01-14T16:32:22Z",
    "updated": "2025-01-14T22:10:27.233901Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-47869",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-j757-pf57-f8r4"
    },
    "description": "### Impact **What kind of vulnerability is it? Who is impacted?** This vulnerability involves a **timing attack** in the way Gradio compares hashes for the `analytics_dashboard` function. Since the comparison is not done in constant time, an attacker could exploit this by measuring the response time of different requests to infer the correct hash byte-by-byte. This can lead to unauthorized access to the analytics dashboard, especially if the attacker can repeatedly query the system with different keys. ### Patches Yes, please upgrade to `gradio>4.44` to mitigate this issue. ### Workarounds **Is there a way for users to fix or remediate the vulnerability without upgrading?** To mitigate the risk before applying the patch, developers can manually patch the `analytics_dashboard` dashboard to use a **constant-time comparison** function for comparing sensitive values, such as hashes. Alternatively, access to the analytics dashboard can be disabled.",
    "ratings": [
      {
        "severity": "low",
        "score": 3.7,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N"
      }
    ],
    "published": "2024-10-10T22:03:29Z",
    "updated": "2025-01-21T18:23:48.693155Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      },
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-10648",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-pgfv-gvc5-prfg"
    },
    "description": "A path traversal vulnerability exists in the Gradio Audio component of gradio-app/gradio, as of version git 98cbcae. This vulnerability allows an attacker to control the format of the audio file, leading to arbitrary file content deletion. By manipulating the output format, an attacker can reset any file to an empty file, causing a denial of service (DOS) on the server.",
    "ratings": [
      {
        "severity": "high",
        "score": 8.2,
        "method": "CVSSv30",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H"
      }
    ],
    "published": "2025-03-20T12:32:39Z",
    "updated": "2025-03-20T20:59:16.442455Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-12217",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-prpg-p95c-32fv"
    },
    "description": "A vulnerability in the gradio-app/gradio repository, version git 67e4044, allows for path traversal on Windows OS. The implementation of the blocked_path functionality, which is intended to disallow users from reading certain files, is flawed. Specifically, while the application correctly blocks access to paths like 'C:/tmp/secret.txt', it fails to block access when using NTFS Alternate Data Streams (ADS) syntax, such as 'C:/tmp/secret.txt::$DATA'. This flaw can lead to unauthorized reading of blocked file paths.",
    "ratings": [
      {
        "severity": "medium",
        "score": 5.3,
        "method": "CVSSv30",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
      }
    ],
    "published": "2025-03-20T12:32:42Z",
    "updated": "2025-03-21T17:43:17.170420Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2024-47870",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-xh2x-3mrm-fwqm"
    },
    "description": "### Impact **What kind of vulnerability is it? Who is impacted?** This vulnerability involves a **race condition** in the `update_root_in_config` function, allowing an attacker to modify the `root` URL used by the Gradio frontend to communicate with the backend. By exploiting this flaw, an attacker can redirect user traffic to a malicious server. This could lead to the interception of sensitive data such as authentication credentials or uploaded files. This impacts all users who connect to a Gradio server, especially those exposed to the internet, where malicious actors could exploit this race condition. ### Patches Yes, please upgrade to `gradio>=5` to address this issue.",
    "ratings": [
      {
        "severity": "high",
        "score": 8.1,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"
      }
    ],
    "published": "2024-10-10T22:04:21Z",
    "updated": "2025-01-21T17:27:41.918921Z",
    "affects": [
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      },
      {
        "ref": "pkg:pypi/gradio@4.37.0"
      }
    ]
  },
  {
    "id": "CVE-2023-50447",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-3f63-hfp8-52jq"
    },
    "description": "Pillow through 10.1.0 allows PIL.ImageMath.eval Arbitrary Code Execution via the environment parameter, a different vulnerability than CVE-2022-22817 (which was about the expression parameter).",
    "ratings": [
      {
        "severity": "high",
        "score": 8.1,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H"
      }
    ],
    "published": "2024-01-19T21:30:35Z",
    "updated": "2025-02-13T05:40:44.483586Z",
    "affects": [
      {
        "ref": "pkg:pypi/pillow@9.5.0"
      }
    ]
  },
  {
    "id": "CVE-2024-28219",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-44wm-f244-xhp3"
    },
    "description": "In _imagingcms.c in Pillow before 10.3.0, a buffer overflow exists because strcpy is used instead of strncpy.",
    "ratings": [
      {
        "severity": "medium",
        "score": 6.7,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:H"
      }
    ],
    "published": "2024-04-03T03:30:30Z",
    "updated": "2025-10-16T08:05:46.219366Z",
    "affects": [
      {
        "ref": "pkg:pypi/pillow@9.5.0"
      }
    ]
  },
  {
    "id": "CVE-2023-44271",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-8ghj-p4vj-mr35"
    },
    "description": "An issue was discovered in Pillow before 10.0.0. It is a Denial of Service that uncontrollably allocates memory to process a given task, potentially causing a service to crash by having it run out of memory. This occurs for truetype in ImageFont when textlength in an ImageDraw instance operates on a long text argument.",
    "ratings": [
      {
        "severity": "high",
        "score": 7.5,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
      }
    ],
    "published": "2023-11-03T06:36:30Z",
    "updated": "2024-10-14T21:23:45.339098Z",
    "affects": [
      {
        "ref": "pkg:pypi/pillow@9.5.0"
      },
      {
        "ref": "pkg:pypi/pillow@9.5.0"
      }
    ]
  },
  {
    "id": "CVE-2023-4863",
    "source": {
      "name": "OSV-DEV",
      "url": "https://osv.dev/vulnerability/GHSA-j7hp-h8jx-5ppr"
    },
    "description": "Heap buffer overflow in libwebp allow a remote attacker to perform an out of bounds memory write via a crafted HTML page.",
    "ratings": [
      {
        "severity": "high",
        "score": 8.8,
        "method": "CVSSv31",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
      }
    ],
    "published": "2023-09-12T15:30:20Z",
    "updated": "2025-07-09T16:28:48.316502Z",
    "affects": [
      {
        "ref": "pkg:pypi/pillow@9.5.0"
      }
    ]
  }
]